<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="pandoc">

<meta name="author" content="Joseph Stachelek">

<meta name="date" content="2015-10-30">

<title>Constructing Peat Collapse Summary Files</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css">

</head>

<body>



<div id="header">
<h1 class="title">Constructing Peat Collapse Summary Files</h1>
<h4 class="author"><em>Joseph Stachelek</em></h4>
<h4 class="date"><em>2015-10-30</em></h4>
</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>peatcollapse</code> package contains functions to clean and
 assemble the various Peat Collapse project datasets into consistent 
summary files. These datasets include:</p>
<ol style="list-style-type: decimal">
<li><p>Conductivity, salinity, and temperature data collected <code>onsite</code> via YSI sonde</p></li>
<li><p>Soil redox-potential readings collected <code>onsite</code></p></li>
<li><p>Water quality chemistry samples processed in the SFWMD <code>lab</code></p></li>
<li><p>Phosphorus samples processed in the SFWMD Everglades <code>lab</code></p></li>
<li><p>Sulfide samples processed at the FBSIC <code>lab</code></p></li>
</ol>
<p>The ultimate goal is to create seperate “database” summary files for 
the Field Study and Key Largo Mesocosm Experiments. These summary files 
should be stand-alone and saved in an open non-proprietary file format 
such as csv.</p>
</div>
<div id="installing-the-peatcollapse-package" class="section level1">
<h1>Installing the <code>peatcollapse</code> package</h1>
<p>The <code>peatcollapse</code> <code>R</code> package is distributed 
via a .tar.gz (analagous to .zip) package archive file. This package 
contains the source code for package functions. In RStudio, it can be 
installed by navigating to Tools -&gt; Install Packages… -&gt; Install 
from: -&gt; Package Archive File. Computers running the Windows 
operating system can only install binary .zip package archive files 
unless they have additional compiler software installed. The <code>peatcollapse</code> binary package can be installed by running the following commands from the R console:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">"RSQLite"</span>, <span class="st">"readxl"</span>, <span class="st">"reshape2"</span>, <span class="st">"DBI"</span>))
<span class="kw">install.packages</span>(<span class="st">"peatcollapse_0.1-1.zip"</span>, <span class="dt">type =</span> <span class="st">"win.binary"</span>, <span class="dt">repos =</span> <span class="ot">NULL</span>)</code></pre></div>
<div id="raw-data" class="section level2">
<h2>Raw Data</h2>
<p>The first step in assembling the peat collapse database is to verify 
that the raw data files are organized in a standardized folder 
structure.</p>
<p>In the following example, the current versions of the compiled database files are located at the top level of the <code>PeatCollapseData</code> directory. Old versions of these compiled files are located in the <code>Archive</code> folder. The contents of the <code>Raw</code> folder are organized into the <code>lab</code> and <code>onsite</code> data folders.</p>
<p>The top level of the <code>lab</code> folder contains prelimary “LIMS” data from the SFWMD lab as well as sulfide data from the FBISC lab. The files in the <code>EDD</code>
 subfolder represent the same data as the “LIMS” files except that they 
have been quality checked by the SFWMD Data Validation Unit. The <code>onsite</code> folder contains the “raw” onsite csv files as well as redox data files.</p>
<pre><code>PeatCollapseData
|    fieldallvX.csv
|    mesoall_soilonly.csv
|    mesoall_soilplantvX.csv
|    pc_eddlab.db
|
|____Archive
|
|____Raw
    |____aquatroll
    |    |   ...
    |
    |____lab
    |    |    201504_Lab_Data_Mar_Apr_2015.csv
    |    |    201506_Lab_Data_Apr_June_2015.csv
    |    |    ...
    |    |    20150923_Sulfide_Raw_ and_CalcsCurves_092315.xlsx
    |    |    20151001_Sulfide_Raw and CalcsCurves_100115.xlsx
    |    |    ...
    |    |
    |    |____EDD
    |    |    |   ...
    |    |    
    |    |____phosphorus
    |    |    |   ...
    |    |
    |    |____mesocosm
    |    |    |   ...
    |    |
    |____onsite
    |    |    20150922_SGPeatCollapse_FreshWFieldData.csv
    |    |    20150922_SGPeatCollapse_BrackishWFieldData.csv
    |    |    20150701_SGPeatCollapse_KLMesosSoilPlant.csv
    |    |    20150312_SGPeat Collapse_KLMesosSoilOnly.csv
    |    |    ...
</code></pre>
</div>
</div>
<div id="data-processing" class="section level1">
<h1>Data Processing</h1>
<p>We begin by loading the <code>peatcollapse</code> package and setting
 the R working directory to the location of the top level peat collapse 
data folder. The following code chunk sets the <code>R</code> “working directory”:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(peatcollapse)
<span class="kw">setwd</span>(<span class="kw">file.path</span>(<span class="st">"/home"</span>, <span class="st">"jose"</span>,<span class="st">"Documents"</span>, <span class="st">"Science"</span>, <span class="st">"Data"</span>, <span class="st">"peatcollapse"</span>))</code></pre></div>
<p>The remainder of the code examples in this document specify 
particular file/folder paths. All of these paths represent the default 
setting. <span style="color:red;">Any path can be altered to reflect a different local file/folder structure.</span>
 All additional parameter specifications respresent the default setting.
 Consult the package documentation to learn about alternatives. 
Documentation can be accessed by typing <code>??</code> followed by the command of interest. For example, to open the documentation for the <code>setwd</code> function enter the following command in the <code>R</code> console:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">??setwd</code></pre></div>
<div id="field-study" class="section level2">
<h2>Field Study</h2>
<div id="onsite-data" class="section level3">
<h3>Onsite Data</h3>
<p>The <code>get_fieldonsite</code> function can be used to obtain 
cleaned onsite data from the ENP field manipulations. First, this 
function searches the folder specified by the <code>onsitepath</code> 
parameter for the latest onsite files from the brackish and freshwater 
sites. It assumes that file names have been preappended with a date in 
YYYYMMDD format. Second, records which were not collected “1 day post” 
dose are removed. Third, the “inout” field is created based on the 
“sipper” data field in order to designate whether measurements were 
collected inside or outside the field chambers. Fourth, the date column 
is formatted to a machine-readable format (YYYY-MM-DD). Finally, 
within-chamber replicates are averaged in preparation for joining to the
 lab data. The <code>get_fieldonsite</code> function can be tested by running the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fieldonsite &lt;-<span class="st"> </span><span class="kw">get_fieldonsite</span>(<span class="dt">onsitepath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"onsite"</span>))</code></pre></div>
</div>
<div id="lab-data" class="section level3">
<h3>Lab Data</h3>
<p>The <code>get_fieldlab</code> function is used to obtain cleaned lab 
data for the ENP field manipulations. First, this function gathers all 
the files from the folder specified by the <code>eddpath</code> parameter and creates an <code>SQLite</code>
 database. Second, the dates associated with the lab samples are 
adjusted to match the nearest field data collections in the results from
 <code>get_fieldonsite</code>. Third, field duplicates are averaged 
together with the standard samples. Fourth, treatment labels are 
calculated based on site and chamber number. Fifth, any missing EDD data
 is obtained from the preliminary LIMS data files.</p>
<p>Interally, the <code>get_fieldlab</code> function calls the <code>clean_p</code> function to obtain data from the folder specified by the <code>ppath</code> parameter and to merge it with the SFWMD lab data. The <code>clean_p</code> function can be tested with the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phosphorus &lt;-<span class="st"> </span><span class="kw">clean_p</span>(<span class="dt">ppath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>, <span class="st">"phosphorus"</span>))</code></pre></div>
<p>Also internal to the <code>get_fieldlab</code> function is a call to the <code>clean_sulfide</code> function. This function obtains data from the folder specified by the <code>sulfpath</code> parameter. Sulfide data files are assumed to be in .xlsx format with a preappended date in YYYYMMDD format. The <code>clean_sulfide</code>
 function retrieves calibration coefficients from all of the individual 
excel sheet tabs and calculates a sulfide concentration in mM units. 
This data is then joined to the combined SFWMD lab and phosphous data. 
The <code>clean_sulfide</code> function can be tested with the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sulfide &lt;-<span class="st"> </span><span class="kw">clean_sulfide</span>(<span class="dt">sulfpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>))$fielddt</code></pre></div>
<p>The <code>get_fieldlab</code> function can be tested by issuing the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fieldlab &lt;-<span class="st"> </span><span class="kw">get_fieldlab</span>(fieldonsite, <span class="dt">eddpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>, <span class="st">"EDD"</span>),
<span class="dt">limspath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>), <span class="dt">ppath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>,
<span class="st">"phosphorus"</span>), <span class="dt">sulfpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>))</code></pre></div>
</div>
<div id="assembly" class="section level3">
<h3>Assembly</h3>
<p>All of the preceeding field onsite and lab data retrieval/cleaning steps can be run from a single call to the high-level <code>assemble_field</code>
 function. This function runs the preceeding commands, merges the 
output, and provides an option to save the results to a summary file. It
 can be run using the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">field &lt;-<span class="st"> </span><span class="kw">assemble_field</span>(<span class="dt">eddpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>, <span class="st">"EDD"</span>),
<span class="dt">limspath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>), <span class="dt">ppath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>,
<span class="st">"phosphorus"</span>), <span class="dt">sulfpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>), <span class="dt">tofile =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>If the <code>tofile</code> parameter is set to <code>TRUE</code>, a summary file will be saved to the current working directory under the name <code>fieldall.csv</code>. This file should be manually appended with a version number before old versions can be moved to the <code>Archive</code> folder.</p>
</div>
</div>
<div id="key-largo-mesocosm-experiments" class="section level2">
<h2>Key Largo Mesocosm Experiments</h2>
<div id="onsite-data-1" class="section level3">
<h3>Onsite Data</h3>
<p>The <code>get_mesoonsite</code> function can be used to obtain 
cleaned onsite data from the FBISC mesocosm studies. This function 
searches the folder specified by the <code>onsitepath</code> parameter 
for the latest onsite files from FBISC mesocosms. It assumes that file 
names have been preappended with a date in YYYYMMDD format. Within-core 
replicates are averaged in preparation for joining to the lab data. The <code>get_mesoonsite</code> function can be tested by running the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mesoonsite &lt;-<span class="st"> </span><span class="kw">get_mesoonsite</span>(<span class="dt">onsitepath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"onsite"</span>), <span class="dt">experiment =</span> <span class="st">"SoilPlant"</span>)</code></pre></div>
</div>
<div id="lab-data-1" class="section level3">
<h3>Lab Data</h3>
<p>The <code>get_mesolab</code> function is used to obtain cleaned lab 
data for the FBISC mesocosm experiments. First, this function gathers 
all the files from the folder specified by the <code>eddpath</code> parameter and creates an <code>SQLite</code>
 database. Second, field duplicates are averaged together with the 
standard samples. Third, crypt and core labels are extracted from the 
location field. These crypt and core labels are used to create a 
“treatment” (trt) field.</p>
<p>Interally, the <code>get_mesolab</code> function calls the <code>clean_sulfide</code> function. This function obtains data from the folder specified by the <code>sulfpath</code> parameter. Sulfide data files are assumed to be in .xlsx format with a preappended date in YYYYMMDD format. The <code>clean_sulfide</code>
 function retrieves calibration coefficients from all of the individual 
excel sheet tabs and calculates a sulfide concentration in mM units. 
This data is then joined to the SFWMD lab data. The <code>clean_sulfide</code> function can be tested with the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sulfide &lt;-<span class="st"> </span><span class="kw">clean_sulfide</span>(<span class="dt">sulfpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>))$mesodt</code></pre></div>
<p>The <code>get_mesolab</code> function can be tested by issuing the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mesolab &lt;-<span class="st"> </span><span class="kw">get_mesolab</span>(<span class="dt">eddpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>, <span class="st">"EDD"</span>), <span class="dt">sulfpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>))</code></pre></div>
</div>
<div id="assembly-1" class="section level3">
<h3>Assembly</h3>
<p>All of the preceeding mesocosm onsite and lab data retrieval/cleaning steps can be run from a single call to the high-level <code>assemble_meso</code>
 function. This function runs the preceeding commands, merges the 
output, and provides an option to save the results to a summary file. It
 can be run using the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meso &lt;-<span class="st"> </span><span class="kw">assemble_meso</span>(<span class="dt">eddpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>, <span class="st">"EDD"</span>),
<span class="dt">sulfpath =</span> <span class="kw">file.path</span>(<span class="st">"Raw"</span>, <span class="st">"lab"</span>), <span class="dt">tofile =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>If the <code>tofile</code> parameter is set to <code>TRUE</code>, a summary file will be saved to the current working directory under the name <code>mesoall_soilplant.csv</code> or <code>mesoall_soilonly.csv</code>. These files should be manually appended with a version number before old versions can be moved to the <code>Archive</code> folder.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>



</body></html>